function U(){return!(typeof process>"u"||!process.cwd||!process.versions||typeof process.versions.node>"u"||!process.release||process.release.name!=="node")}function $(e,n){let t;{var r=Error.stackTraceLimit;Error.stackTraceLimit=1/0,t=new Error(e),Error.stackTraceLimit=r}return U()&&(t.stack=D(t.stack,n)),t}function D(e,n){if(!e)return e;const t=G(e);let r=0;return t.filter(i=>i.includes(" (internal/")||i.includes(" (node:internal")?!1:r<n&&F(i)?(r++,!1):!0).join(`
`)}function F(e){return e.startsWith("    at ")}function G(e){return e.split(/\r?\n/)}function w(e,n){const t=globalThis.__vike=globalThis.__vike||{};return t[e]=t[e]||n}function b(e){return typeof e=="object"&&e!==null}function Y(e){return Array.from(new Set(e))}const l=w("assertPackageInstances.ts",{instances:[],alreadyLogged:new Set}),q="The client runtime of Server Routing as well as the client runtime of Client Routing are both being loaded. Make sure they aren't loaded both at the same time for a given page. See https://vike.dev/client-runtimes-conflict",O="Two vike client runtime instances are being loaded. Make sure your client-side bundles don't include vike twice. (In order to reduce the size of your client-side JavaScript bundles.)";function x(){{const e=Y(l.instances);K(e.length<=1,`Both vike@${e[0]} and vike@${e[1]} loaded. Only one version should be loaded.`)}l.checkSingleInstance&&l.instances.length>1&&T(!1,O,{onlyOnce:!0,showStackTrace:!0})}function de(e){T(l.isClientRouting!==!1,q,{onlyOnce:!0,showStackTrace:!0}),T(l.isClientRouting===void 0,O,{onlyOnce:!0,showStackTrace:!0}),l.isClientRouting=!0,e&&(l.checkSingleInstance=!0),x()}function z(e){l.instances.push(e),x()}function K(e,n){if(e)return;const t=`[vike][Wrong Usage] ${n}`;throw new Error(t)}function T(e,n,{onlyOnce:t,showStackTrace:r}){if(e)return;const o=`[vike][Warning] ${n}`;if(t){const{alreadyLogged:i}=l,a=t===!0?o:t;if(i.has(a))return;i.add(a)}console.warn(r?new Error(o):o)}const Q="0.4.148",f={projectName:"Vike",projectVersion:Q,npmPackageName:"vike",githubRepository:"https://github.com/vikejs/vike"};z(f.projectVersion);const W=new Proxy(e=>e,{get:()=>W}),c=W,s=w("utils/assert.ts",{alreadyLogged:new Set,logger(e,n){n==="info"?console.log(e):console.warn(e)},showStackTraceList:new WeakSet}),X=`[${f.npmPackageName}]`,Z=`[${f.npmPackageName}@${f.projectVersion}]`,S=2;function h(e,n){var a;if(e)return;const t=(()=>{if(!n)return null;const d=typeof n=="string"?n:JSON.stringify(n);return c.dim(`Debug info (for ${f.projectName} maintainers; you can ignore this): ${d}`)})(),r=`${f.githubRepository}/issues/new`;let o=[`You stumbled upon a bug in ${f.projectName}'s source code.`,`Go to ${c.blue(r)} and copy-paste this error; a maintainer will fix the bug (usually under 24 hours).`,t].filter(Boolean).join(" ");o=g(o),o=y(o,"Bug"),o=p(o,!0);const i=$(o,S);throw(a=s.onBeforeLog)==null||a.call(s),i}function R(e,n,{showStackTrace:t}={}){var o;if(e)return;n=g(n),n=y(n,"Wrong Usage"),n=p(n);const r=$(n,S);throw t&&s.showStackTraceList.add(r),(o=s.onBeforeLog)==null||o.call(s),r}function M(e){return e=g(e),e=y(e,"Error"),e=p(e),$(e,S)}function v(e,n,{onlyOnce:t,showStackTrace:r}){var o;if(!e){if(n=g(n),n=y(n,"Warning"),n=p(n),t){const{alreadyLogged:i}=s,a=t===!0?n:t;if(i.has(a))return;i.add(a)}if((o=s.onBeforeLog)==null||o.call(s),r){const i=new Error(n);s.showStackTraceList.add(i),s.logger(i,"warn")}else s.logger(n,"warn")}}function ee(e,n,{onlyOnce:t}){var r;if(!e){if(n=g(n),n=p(n),t){const{alreadyLogged:o}=s,i=n;if(o.has(i))return;o.add(i)}(r=s.onBeforeLog)==null||r.call(s),s.logger(n,"info")}}function y(e,n){let t=`[${n}]`;const r=n==="Warning"?"yellow":"red";return t=c.bold(c[r](t)),`${t}${e}`}function g(e){return e.startsWith("[")?e:` ${e}`}function p(e,n=!1){return`${n?Z:X}${e}`}function I(){return typeof window<"u"&&typeof window.scrollY=="number"}const B=w("utils/assertRouterType.ts",{});function ne(){re(te()),B.isClientRouting=!0}function te(){return B.isClientRouting!==!1}function re(e){R(I(),`${c.cyan("import { something } from 'vike/client/router'")} is forbidden on the server-side`,{showStackTrace:!0}),v(e,"You shouldn't `import { something } from 'vike/client/router'` when using Server Routing. The 'vike/client/router' utilities work only with Client Routing. In particular, don't `import { navigate }` nor `import { prefetch }` as they unnecessarily bloat your client-side bundle sizes.",{showStackTrace:!0,onlyOnce:!0})}function oe(e){return e instanceof Function||typeof e=="function"}function ie(e,n,t="unknown"){if(!b(e))return!1;if(!(n in e))return t==="undefined";if(t==="unknown")return!0;const r=e[n];return t==="array"?Array.isArray(r):t==="object"?b(r):t==="string[]"?Array.isArray(r)&&r.every(o=>typeof o=="string"):t==="function"?oe(r):Array.isArray(t)?typeof r=="string"&&t.includes(r):t==="null"?r===null:t==="undefined"?r===void 0:t==="true"?r===!0:t==="false"?r===!1:typeof r===t}function k(e,n){n&&Object.defineProperties(e,Object.getOwnPropertyDescriptors(n))}function L(e){const n=e/1e3;if(n<120){const t=C(n);return`${t} second${A(t)}`}{const t=n/60,r=C(t);return`${r} minute${A(r)}`}}function C(e){let n=e.toFixed(1);return n.endsWith(".0")&&(n=n.slice(0,-2)),n}function A(e){return e==="1"?"":"s"}const se=w("utils/executeHook.ts",{userHookErrors:new Map});function he(e,n){const{hookName:t,hookFilePath:r,hookTimeout:{error:o,warning:i}}=n;let a,d;const J=new Promise((u,H)=>{a=m=>{E(),u(m)},d=m=>{E(),H(m)}}),E=()=>{j&&clearTimeout(j),_&&clearTimeout(_)},j=P(i)&&setTimeout(()=>{v(!1,`The ${t}() hook defined by ${r} is slow: it's taking more than ${L(i)} (https://vike.dev/hooksTimeout)`,{onlyOnce:!1})},i),_=P(o)&&setTimeout(()=>{const u=M(`The ${t}() hook defined by ${r} timed out: it didn't finish after ${L(o)} (https://vike.dev/hooksTimeout)`);d(u)},o);return(async()=>{try{const u=await e();a(u)}catch(u){b(u)&&se.userHookErrors.set(u,{hookName:t,hookFilePath:r}),d(u)}})(),J}function P(e){return!!e&&e!==1/0}function ae(e,n,t=r=>r){if(h(e.length>0),e.length===1)return t(e[0]);const r=e.slice(0,e.length-1),o=e[e.length-1];return r.map(t).join(", ")+` ${n} `+t(o)}function ce(e,n){const t=n-3;if(h(t>=1),e.length<n)return e;{e=e.substring(0,t);const r=c.dim("...");return e=e+r,e}}I()&&ne();function ge(e,n){const t=[typeof e=="number"?String(e):JSON.stringify(e)];n!==void 0&&t.push(ce(JSON.stringify(n),30));const r="throw render()",o=`throw render(${t.join(", ")})`;return ue(e,n,o,r)}function ue(e,n,t,r,o){const i={abortReason:n,_abortCaller:r,_abortCall:t};if(o&&(h(o._isLegacyRenderErrorPage===!0),k(i,o)),typeof e=="string")return k(i,{_urlRewrite:e}),N(i);{const a=e;return le(e,[401,403,404,410,429,500,503],"render"),k(i,{abortStatusCode:a,is404:a===404}),N(i)}}function N(e){const n=new Error("AbortRender");return k(n,{_pageContextAbort:e,[V]:!0}),n}const V="_isAbortError";function pe(e){return typeof e=="object"&&e!==null&&V in e}function ke(e){return e._urlRewrite||e._urlRedirect||e.abortStatusCode?(h(ie(e,"_abortCall","string")),!0):!1}function we(e,n,t){if(n)return;const r=t._urlRewrite??t.urlOriginal;h(r);const o=e._pageContextAbort._abortCall;ee(!1,`${c.cyan(o)} intercepted while rendering ${c.cyan(r)}`,{onlyOnce:!1})}function le(e,n,t){const r=ae(n.map(o=>o.toString()),"or");v(n.includes(e),`Unepexected status code ${e} passed to ${t}(), we recommend ${r} instead. (Or reach out at ${f.githubRepository}/issues/1008 if you believe ${e} should be added.)`,{onlyOnce:!0})}function ye(e){fe(e);const n={_urlRewrite:null};return e.forEach(t=>{Object.assign(n,t)}),n}function fe(e){const n=[];e.forEach(t=>{const r=t._urlRewrite;{const o=n.indexOf(r);if(o!==-1){const i=[...n.slice(o),r].map(a=>`render('${a}')`).join(" => ");R(!1,`Infinite loop of render() calls: ${i}`)}}n.push(r)})}function me(e,n){const t=[e>0&&c.cyan("throw render('/some-url')"),n>0&&c.cyan("throw redirect('/some-url')")].filter(Boolean).join(" and ");R(e+n<=7,`Maximum chain length of 7 ${t} exceeded. Did you define an infinite loop of ${t}?`)}export{N as A,ne as a,R as b,te as c,h as d,oe as e,b as f,k as g,ie as h,I as i,v as j,w as k,he as l,M as m,ke as n,de as o,c as p,ee as q,ge as r,ae as s,me as t,Y as u,ye as v,pe as w,we as x};
